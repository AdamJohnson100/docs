<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This topic describes how to configure the Wavefront proxy.">
<meta name="keywords" content="proxies,  ">
<title>Wavefront Proxy Configuration | Wavefront</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-91867056-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/wavefront_favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand" href="/wf-docs/index.html">
                <img src="/wf-docs/images/wavefront_logo_white.png"></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="index.html">Documentation</a></li>
                
                
                
                <li><a href="news">News</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:stephanie@wavefront.com?subject=Wavefront Documentation feedback&body=I have some feedback about the Wavefront Proxy Configuration page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Wavefront Proxy Configuration">{title}</a></li>',
                                noResultsText: 'No results found.', limit: 10, fuzzy: true, })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          


<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Wavefront </li>
    
    
    
    <li>
        <a href="#">Overview</a>
        <ul>
            
            
            
            <li><a href="index.html">About Wavefront Documentation</a></li>
            
            
            
            
            
            
            <li><a href="introduction.html">Introduction to Wavefront</a></li>
            
            
            
            
            
            
            <li><a href="tags.html">Introduction to Tags</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Release Notes</a>
        <ul>
            
            
            
            <li><a href="50_release_notes.html">5.0 Release Notes</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Proxies</a>
        <ul>
            
            
            
            <li><a href="wavefront_cli.html">Wavefront CLI</a></li>
            
            
            
            
            
            
            <li class="active"><a href="proxy_configuration.html">Wavefront Proxy Configuration</a></li>
            
            
            
            
            
            
            <li><a href="proxy_preprocessor_rules.html">Configuring Wavefront Proxy Preprocessor Rules</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Query Language</a>
        <ul>
            
            
            
            <li><a href="time_series_language_reference.html">Time Series Query Language Reference</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Dashboards</a>
        <ul>
            
            
            
            <li><a href="intro_dashboards.html">Introductory Dashboards</a></li>
            
            
            
            
            
            
            <li><a href="managing_dashboards.html">Managing Dashboards</a></li>
            
            
            
            
            
            
            <li><a href="dashboard_variables.html">Dashboards Variables</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Events</a>
        <ul>
            
            
            
            <li><a href="events.html">Events</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Integrations</a>
        <ul>
            
            
            
            <li><a href="aws_metrics_integration.html">AWS Metrics Integration</a></li>
            
            
            
            
            
            
            <li><a href="external_links.html">External Links</a></li>
            
            
            
            
            
            
            <li><a href="sending_log_data.html">Sending Log Data Metrics To Wavefront</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Tags</a>
        <ul>
            
            
            
            <li><a href="tag_overview.html">Tag Overview</a></li>
            
            
            
            <li class="subfolders">
                <a href="#">Tag Pages</a>
                <ul>
                    
                    
                    
                    <li><a href="tag_getting_started.html">Getting Started Pages</a></li>
                    
                    
                    
                    
                    
                    <li><a href="tag_dashboards.html">Dashboards Pages</a></li>
                    
                    
                    
                    
                    
                    <li><a href="tag_integrations.html">Integrations Pages</a></li>
                    
                    
                    
                    
                    
                    <li><a href="tag_proxies.html">Proxies Pages</a></li>
                    
                    
                    
                    
                    
                    <li><a href="tag_query_language.html">Query Language Pages</a></li>
                    
                    
                    
                </ul>
            </li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Wavefront Proxy Configuration</h1>
</div>



<div class="post-content">

   
    <div class="summary">This topic describes how to configure the Wavefront proxy.</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    
<!--
    <a target="_blank" href="https://github.com/WavefrontHQ/docs/gh-pagespages//proxy_configuration.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
-->
    

  <p>This document describes Wavefront proxy 4.4 configuration options. For changes since previous proxy versions, see <a href="https://community.wavefront.com/docs/DOC-1131">Wavefront Proxy Version History</a>.</p>

<h2 id="installing-a-proxy">Installing a Proxy</h2>

<p>To install a proxy, follow the directions in <a href="https://community.wavefront.com/docs/DOC-1271">Installing Wavefront Proxies</a>. The installation procedures perform basic configuration. For advanced configuration, see the options in the next section.</p>

<h2 id="configuration-options">Configuration Options</h2>

<p>The Wavefront proxy configuration is maintained in <code class="highlighter-rouge">/etc/wavefront/wavefront-proxy/wavefront.conf</code>. Besides the server and hostname properties, the configuration file offers a variety of other options for changing how the proxy processes your data. None of these need to be changed from their default values, but can be adjusted for your particular needs. After changing a configuration option, <a href="https://community.wavefront.com/docs/DOC-1083#jive_content_id_Starting_and_Stopping_a_Proxy">restart the proxy service</a>.</p>

<table width="100%" id="configTable" class="display">
<colgroup>
<col width="40%" />
<col width="20%" />
<col width="20%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr>
<th>Property</th>
<th>Purpose</th>
<th>Format</th>
<th>Example</th>
<th>Since Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>MetricsPointTags</td>
<td>Point tags and their values (as key-value pairs) to be passed along with ~agent.* metrics. Default: none.</td>
<td>A comma-separated list of key-value pairs.</td>
<td>dc=west,env=prod</td>
<td>3.24</td>
</tr>
<tr>
<td>blacklistRegex</td>
<td>Regex pattern (java.util.regex) that input lines must match to be filtered out. Input lines are checked against the pattern as they come in and before the prefix is prepended.</td>
<td>A valid regex pattern.</td>
<td>Filter out points that begin with qa., development., or test.<br />
^(qa|development|test).</td>
<td>3.1</td>
</tr>
<tr>
<td>buffer</td>
<td>Location of buffer files for saving failed transmissions for retry. Default: <code class="highlighter-rouge">/var/spool/wavefront-proxy/buffer</code>.</td>
<td>A valid path on the local file system.</td>
<td><code class="highlighter-rouge">/var/spool/wavefront-proxy/buffer</code></td>
<td>3.20</td>
</tr>
<tr>
<td>customSourceTags</td>
<td>A comma-separated list of point tags to use as 'source' if no 'source' or 'host' field is present. Default: fqdn, hostname.</td>
<td>A comma-separated list of point tags.</td>
<td>fqdn, hostname</td>
<td>3.14</td>
</tr>
<tr>
<td>dataBackfillCutoffHours</td>
<td>Sets the cut-off point for what is considered a valid timestamp for back-dated points. We do not recommend setting this value higher than 1 year unless backfilling or migrating historic data. Default: 8760 (1 year), so all the data points older than 1 year are rejected.</td>
<td>A positive integer.</td>
<td>8760</td>
<td>4.1</td>
</tr>
<tr>
<td>ephemeral</td>
<td>Indicates whether to automatically clean up old and orphaned proxy instances from the Wavefront Agents page. We recommend enabling ephemeral mode if you’re running the proxy in a container that may be frequently spun down and recreated. Default: false.</td>
<td>true or false</td>
<td>true</td>
<td>3.14</td>
</tr>
<tr>
<td>fileBeatPort</td>
<td>Port to listen for Filebeat data. Default: 5044.</td>
<td>A port number.</td>
<td>5044</td>
<td>4.1</td>
</tr>
<tr>
<td>flushThreads</td>
<td>Number of threads that flush data to the server. Setting this value too high will result in sending batches that are too small to the Wavefront server and wasting connections. Values between 6 and 16 are a good starting point. This setting is per listening port. Default: The number of available processors (min 4).</td>
<td>A positive integer.</td>
<td>16.</td>
<td>3.14</td>
</tr><tr>
<td>graphitePorts</td>
<td>Ports to listen on for Graphite data. Define which of the segments in your Graphite metrics map to a hostname in the graphiteFormat property. Default: 2003.</td>
<td>A comma-separated list of available port numbers. Can be a single port.</td>
<td>2003<br />
2003,2004</td>
<td></td>
</tr>
<tr>
<td>graphiteFormat</td>
<td>Indexes of fields within your Graphite/collectd metric names that correspond to a hostname. For example, if your metrics have the format: collectd.prod.www04.cpu.loadavg.1m specify the 3rd and 2nd indexes (www04.prod) to be extracted and treated as the hostname. The remainder (collectd.cpu.loadavg.1m) is treated as the metric name.</td>
<td>A comma-separated list of indexes.</td>
<td>3,2<br />
4,2,5<br />
3</td>
<td></td>
</tr>
<tr>
<td>graphiteDelimiters</td>
<td>Characters that should be replaced by dots, in case they were escaped within Graphite/collectd before sending. A common delimiter is the underscore character; so if you extract a hostname field with the value 'web04_www', it is changed to 'web04.www'.</td>
<td>A concatenation of delimiter characters, without any separators.</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>hostname</td>
<td>A name unique across your account representing the machine that the proxy is running on. The hostname is not used to tag your metrics; rather, it's used to tag proxy metrics, such as JVM statistics, per-Proxy point rates, and so on.</td>
<td>An string containing alphanumeric characters and periods.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>httpConnectTimeout</td>
<td>HTTP connect timeout (in milliseconds). Default: 5000 (5s).</td>
<td>A positive integer.</td>
<td>5000</td>
<td>4.1</td>
</tr>
<tr>
<td>httpRequestTimeout</td>
<td>HTTP request timeout (in milliseconds). We do not recommend setting this value to be higher than 20000. Recommended value for most configurations is 10000 (10 seconds). Default: 20000 (20s).</td>
<td>A positive integer.</td>
<td>10000</td>
<td>4.1</td>
</tr>
<tr>
<td>httpUserAgent</td>
<td>Override User-Agent in request headers. Can help bypass excessively restrictive filters on the HTTP proxy. Default user agent: Wavefront-Proxy/&lt;version&gt;.</td>
<td>A string.</td>
<td>'Mozilla/5.0'</td>
<td>4.1</td>
</tr>
<tr>
<td>idFile</td>
<td>Location of the PID file for the wavefront-proxy process. Default: <code class="highlighter-rouge">~/.dshell/id</code>.</td>
<td>A valid path on the local file system.</td>
<td><code class="highlighter-rouge">/etc/wavefront/wavefront-proxy/.wavefront_id</code></td>
<td></td>
</tr>
<tr>
<td>jsonListenerPorts</td>
<td>Ports to listen on for incoming JSON-formatted metrics. Default: none.</td>
<td>A comma-separated list of available port numbers. Can be a single port.</td>
<td></td>
<td></td>
</tr><tr>
<td>logsIngestionConfigFile</td>
<td>The file containing instructions for parsing log data into metrics.  See <a href="sending_log_data.html">Sending Log Data Metrics To Wavefront</a>.
Default: <code class="highlighter-rouge">/etc/wavefront/wavefront-proxy/logsIngestion.yaml</code>.</td>
<td>A valid path on the local file system.</td>
<td></td>
<td>4.1</td>
</tr>
<tr>
<td>opentsdbPorts</td>
<td>Ports to listen on for incoming OpenTSDB-formatted data. Default: none.
Default: 4242.</td>
<td>A comma-separated list of available port numbers. Can be a single port.</td>
<td>4242</td>
<td>3.1</td>
</tr>
<tr>
<td>picklePorts</td>
<td>Ports to listen on for incoming data in Graphite Pickle format (from carbon-relay). Default: none.</td>
<td>A comma-separated list of available port numbers. Can be a single port.</td>
<td>5878</td>
<td>3.20</td>
</tr>
<tr>
<td>prefix</td>
<td>String to prepend before every metric name. For example, if you set prefix to 'production', a metric that is sent to the proxy as 'cpu.loadavg.1m' is sent from the proxy to Wavefront as 'production.cpu.loadavg.1m'. You can include longer prefixes such as 'production.nyc.dc1', and so on. Default: none.</td>
<td>A lowercase alphanumeric string, with periods separating segments. You do not need to include a trailing period.</td>
<td>production
production.nyc.dc1</td>
<td></td>
</tr>
<tr>
<td>preprocessorConfigFile</td>
<td>Path to the optional preprocessor config file containing <a href="proxy_preprocessor_rules.html">preprocessor rules</a> for filtering and rewriting points. Default: none.</td>
<td>A valid path on the local file system.</td>
<td><code class="highlighter-rouge">/etc/wavefront/wavefront-proxy/preprocessor_rules.yaml</code></td>
<td>4.1</td>
</tr>
<tr>
<td>proxyHost</td>
<td>HTTP proxy host to be used in configurations when direct HTTP connections to Wavefront servers are not possible (must be used with proxyPort).</td>
<td>A string.</td>
<td>proxy.local</td>
<td>3.23</td>
</tr>
<tr>
<td>proxyPassword</td>
<td>When used with proxyUser, sets credentials to use with the HTTP proxy if it requires authentication.</td>
<td>A string.</td>
<td>validPassword123</td>
<td>3.23</td>
</tr>
<tr>
<td>proxyPort</td>
<td>HTTP proxy port to be used in configurations when direct HTTP connections to Wavefront servers are not possible (must be used with proxyHost).</td>
<td>A port number.</td>
<td>8080</td>
<td>3.23</td>
</tr>
<tr>
<td>proxyUser</td>
<td>When used with proxyPassword, sets credentials to use with the HTTP proxy if it requires authentication.</td>
<td>A string.</td>
<td>validUser</td>
<td>3.23</td>
</tr>
<tr>
<td>pushBlockedSamples</td>
<td>Number of blocked points to print to the log immediately following each summary line (every 10 flushes). If 0, print none of them. If you are seeing a non-zero number of blocked points in the summary lines and want to debug what that data is, we recommend setting this to 5 or so. Default: 0.</td>
<td>0 or a positive integer.</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>pushFlushInterval</td>
<td>Milliseconds to wait between each flush to Wavefront. Default: 1000.</td>
<td>An integer equal to or greater than 1000.</td>
<td>1000</td>
<td></td>
</tr>
<tr>
<td>pushFlushMaxPoints</td>
<td>Maximum number of points to send to Wavefront during each flush. Default: 40,000.</td>
<td>A positive integer.</td>
<td>40000</td>
<td></td>
</tr>
<tr>
<td>pushListenerPorts</td>
<td>Ports to listen on for incoming data. Default: 2878.</td>
<td>A comma-separated list of available port numbers. Can be a single port.</td>
<td>2878<br />
2878,2879,2880</td>
<td></td>
</tr>
<tr>
<td>pushLogLevel</td>
<td>Frequency to print status information on the data flow to the log. SUMMARY prints a line every 60 flushes, while DETAILED prints a line on each flush.</td>
<td>NONE, SUMMARY, or DETAILED</td>
<td>SUMMARY</td>
<td></td>
</tr>
<tr>
<td>pushMemoryBufferLimit</td>
<td>Maximum number of points that can stay in memory buffers before spooling to disk. Setting this value lower than default reduces memory usage but forces the proxy to queue points by spooling to disk more frequently, if you have points arriving at the proxy in short bursts. Default: 16 * pushFlushMaxPoints. Minimum: pushFlushMaxPoints.</td>
<td>A positive integer.</td>
<td>640000</td>
<td>4.1</td>
</tr>
<tr>
<td>pushRateLimit</td>
<td>Maximum number of points to send to Wavefront per minute. Default: unlimited.</td>
<td>A positive integer.</td>
<td>20000</td>
<td>4.1</td>
</tr>
<tr>
<td>pushValidationLevel</td>
<td>Level of validation on incoming data that should be performed before sending the data to Wavefront. If NO_VALIDATION, all data is sent forward. If NUMERIC_ONLY, data is checked to make sure that it is numerical and dropped locally if it is not.</td>
<td>NUMERIC_ONLY or NO_VALIDATION</td>
<td>NUMERIC_ONLY</td>
<td></td>
</tr>
<tr>
<td>rawLogsPort</td>
<td>TCP port to listen for log data. Default: 5045.</td>
<td>A port number.</td>
<td>5045</td>
<td>4.4</td>
</tr>
<tr>
<td>retryBackoffBaseSeconds</td>
<td>For exponential back-off when retry threads are throttled, the base (a in a^b) in seconds. Default: 2.0.</td>
<td>A positive number, integer or decimal.</td>
<td>2.0</td>
<td></td>
</tr>
<tr>
<td>retryThreads</td>
<td>Number of threads retrying failed transmissions. If no value is specified, it defaults to the number of processor cores available to the host or 4, whichever is greater. Every retry thread uses a separate buffer file (capped at 2GB) to persist queued data points, so the number of threads effectively controls the maximum amount of space that the proxy can potentially use to buffer points locally.</td>
<td>A positive integer.</td>
<td>4</td>
<td></td>
</tr>
<tr>
<td>server</td>
<td>The Wavefront server API URL.</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>soLingerTime</td>
<td>Enables SO_LINGER with the specified linger time in seconds. We recommend setting this value to 0 when running in a high-availability configuration under a load balancer.Default: 0 (disabled). </td>
<td>0 or a positive integer.</td>
<td>0</td>
<td>4.1</td>
</tr>
<tr>
<td>splitPushWhenRateLimited</td>
<td>Whether to split the push batch size when the push is rejected by Wavefront due to rate limit. Default: false.</td>
<td>true or false</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>whitelistRegex</td>
<td>Regex pattern (java.util.regex) that input lines must match to be accepted. Input lines are checked against the pattern as they come in and before the prefix is prepended.</td>
<td>A valid regex pattern.</td>
<td>Allow points that begin with production. and stage..<br />
^(production|stage).
</td>
<td>3.1</td>
</tr>
<tr>
<td>writeHttpJsonListenerPorts</td>
<td>Ports to listen on for incoming data from collectd write_http plugin. Default: none.</td>
<td>A comma-separated list of available port numbers. Can be a single port. </td>
<td>4878</td>
<td>3.14</td>
</tr>
</tbody>
</table>

<h2 id="data-buffering">Data Buffering</h2>

<p>If the Wavefront proxy is unable to post received data to the Wavefront servers, it buffers the data to disk across a number of buffer files, and then tries to resend the points once the connection to the Wavefront servers is available again. If this buffering occurs, you’ll see lines like this in wavefront.log:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>2013-11-18 18:02:35,061 WARN  [com.wavefront.daemon.QueuedSshDaemonService] current retry queue sizes: [1/0/0/0]
</code></pre>
</div>

<p>By default, there are 4 threads (and 4 buffer files) waiting to retry points once the connections are up; this line shows how many blocks of points have been stored by each thread (in this case, the first thread has 1 block of queued points, while the second, third, and fourth threads all have 0 blocks). These lines are only printed when there are points in the queue; you’ll never see a line with all 0’s in the queue sizes. Once the connection to the Wavefront servers has been established, and all the threads have sent the past data to us, you’ll see a single line like this in wavefront.log:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>2013-11-18 18:59:46,665 WARN [com.wavefront.daemon.QueuedSshDaemonService] retry queue has been cleared
</code></pre>
</div>

<h2 id="log-configuration">Log Configuration</h2>

<p>The Wavefront proxy supports two log files: proxy log and blocked point log. To keep the log file sizes reasonable and avoid filling up the disk with logs, both log files are automatically rotated and purged periodically. You configure the log file locations and rotation rules in <code class="highlighter-rouge">/etc/wavefront/wavefront-proxy/log4j2.xml</code>. For details on log4j2 configuration, see <a href="https://logging.apache.org/log4j/2.x/manual/configuration.html">Log4j Configuration</a>.</p>

<h3 id="proxy-log">Proxy Log</h3>

<p>By default, proxy log entries are logged to <code class="highlighter-rouge">/var/log/wavefront/wavefront.log</code>. The log file is rolled over every day and when its size reaches 100MB. When there are 30 log files, older files are deleted. </p>

<h3 id="blocked-point-log">Blocked Point Log</h3>

<p>You can log raw blocked points in a separate log from the proxy log. Logging of blocked points is disabled by default. To enable logging block points, edit the log4j2 configuration file and uncomment the blocked points file appender:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;!--
    &lt;AppenderRef ref="BlockedPointsFile"/&gt;
--&gt;
</code></pre>
</div>

<p>By default, blocked point entries are logged to <code class="highlighter-rouge">/var/log/wavefront/wavefront-blocked-points.log</code> and the block point log file is rolled over every day and when its size reaches 100MB. When there are 31 log files, older files are deleted.</p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>If you have any other issues not listed below, or are having trouble resolving an issue, contact us at <a href="mailto:support@wavefront.com">support@wavefront.com</a>.</p>

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr>
<th>Error</th>
<th>Reason</th>
<th>Resolution</th>
</tr>
</thead>
<tbody>
<tr>
<td>You see "java: command not found" in wavefront.log.</td>
<td>Java is either not installed, or is not in your path.</td>
<td>Install Java using your local package manager, and make sure that your path includes the Java binary.</td>
</tr>
<tr>
<td>You see "Cannot fetch daemon configuration from remote server: org.jboss.resteasy.client.exception.ResteasyIOException: IOException" in <code class="highlighter-rouge">wavefront.log</code>.</td>
<td>You may have an incorrect server URL in your wavefront.conf file; you may have blocked the outgoing connection to that server URL (port 443); or the Wavefront servers may be down.</td>
<td>Run <code>curl &lt;wavefrontServerUrl&gt;</code> from the machine running the Proxy, where <code>&lt;wavefrontServerUrl&gt;</code> is the full URL (including "https://) provided to you by Wavefront and in your <code class="highlighter-rouge">wavefront.conf</code> file. If this fails, and you are certain that there are no firewall issues, contact <a href="mailto:support@wavefront.com">support@wavefront.com</a>.</td>
</tr>
<tr>
<td>You see "Cannot post work unit result to Wavefront servers. Will enqueue and retry later." in <code class="highlighter-rouge">wavefront.log</code>.</td>
<td>You may have an incorrect server URL in your wavefront.conf file; you may have blocked the outgoing connection to that server URL (port 443); or the Wavefront servers may be down.</td>
<td>Run <code>curl &lt;wavefrontServerUrl&gt;</code> from the machine running the Proxy, where <code>&lt;wavefrontServerUrl&gt;</code> is the full URL (including "https://") provided to you by Wavefront and in your <code class="highlighter-rouge">wavefront.conf</code> file. If this fails, and you are certain that there are no firewall issues, contact <a href="mailto:support@wavefront.com">support@wavefront.com</a>.</td>
</tr>
<tr>
<td>You see "Exception in thread "main" java.lang.UnsupportedClassVersionError:
com/sunnylabs/GraphiteValidator : Unsupported major.minor version 51.0" in <code class="highlighter-rouge">wavefront.log</code>.&lt;/span&gt;
</td>
<td>You are using Java 1.6 or lower instead of Java 1.7.</td>
<td>Upgrade Java to 1.7 through your local package manager.</td>
</tr>
<tr>
<td>You see "Exception in thread "Thread-2" java.net.BindException: Address already in use" in <code class="highlighter-rouge">wavefront.log</code>.</td>
<td>You already have another process listening on port 2878, or may have started two proxies accidentally.</td>
<td>Use the "ps" command to find and kill any existing proxies, and then start the proxy again.</td>
</tr>
<tr>
<td>You can't "telnet localhost 2878"; the connection is refused.</td>
<td>You may have an iptables rule blocking the traffic; the proxy might not be running; or you may be running "telnet localhost 2878" from a different machine from where the proxy is running.</td>
<td>Use the <code class="highlighter-rouge">ps</code> command to make sure that the proxy is running, and examine your iptables rules to ensure that tcp port 2878 is accessible locally.</td>
</tr>
</tbody>
</table>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_proxies.html" class="btn btn-default navbar-btn cursorNorm" role="button">proxies</a>
        
        
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Wavefront. All rights reserved. <br />
 Site last generated: Feb 15, 2017 <br />
<p></p>
<p><img src="images/wavefront_logo.png" alt="Wavefront logo"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-91867056-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>



</html>